(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4043)}])},4043:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return N}});var r=t(5893),n=t(7484),a=t.n(n),l=t(5675),c=t.n(l),i=t(1664),d=t.n(i),o=t(7294);let u=e=>{let{recording:s}=e,t="https://apiv2.twitcasting.tv/users/".concat(s.screen_id,"/live/thumbnail?size=large&position=latest"),n="https://twitcasting.tv/".concat(s.screen_id);return(0,r.jsxs)("div",{className:"mx-3 space-y-1 rounded-xl border-2 border-indigo-400 bg-slate-200 py-6 shadow-2xl",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(d(),{href:n,children:(0,r.jsx)(c(),{src:t,alt:"".concat(s.user_name,"'s thumbnail"),height:300,width:200,priority:!0,className:"rounded-xl"})})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(d(),{href:n,children:(0,r.jsxs)("div",{className:"my-2 space-y-1",children:[(0,r.jsx)("span",{className:"mx-1 block font-semibold",children:s.live_title}),(0,r.jsx)("span",{className:"mx-1 block",children:s.live_subtitle?s.live_subtitle:"-----"}),(0,r.jsxs)("span",{className:"mx-1 block text-sm font-light text-gray-600",children:[a().unix(s.start_time).format("YYYY/MM/DD HH:mm:ss")," -"," ",a()().diff(a().unix(s.start_time),"minute"),"分経過"]})]})})}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 py-3",children:[(0,r.jsx)(d(),{href:s.profile_image,children:(0,r.jsx)(c(),{src:s.profile_image,alt:"".concat(s.screen_id,"'s icon"),height:45,width:45,className:"rounded-3xl border-2 border-red-600 p-0.5"})}),(0,r.jsx)(d(),{href:n,children:(0,r.jsxs)("div",{className:"w-[150px]",children:[(0,r.jsx)("span",{className:"block truncate text-base font-semibold",children:s.user_name}),(0,r.jsxs)("span",{className:"block truncate text-sm text-gray-400",children:["@",s.screen_id]})]})})]})]})};var x=t(9008),h=t.n(x);let m=e=>{let{user:s}=e,t="https://twitcasting.tv/".concat(s.screen_id);return(0,r.jsxs)("div",{className:"space-y-1 rounded-xl border-2 border-amber-500 bg-white py-6 shadow-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 py-3",children:[(0,r.jsx)(d(),{href:t,children:(0,r.jsx)(c(),{src:s.profile_image?s.profile_image:"https://twitcasting.tv/img/twitcas_guest1_64.jpg",alt:"".concat(s.screen_id,"'s icon"),height:45,width:45,className:"rounded-3xl border-2 border-gray-500"})}),(0,r.jsx)(d(),{href:t,children:(0,r.jsxs)("div",{className:"w-[180px]",children:[(0,r.jsx)("span",{className:"block truncate text-base font-semibold",children:s.user_name}),(0,r.jsxs)("span",{className:"block truncate text-sm text-gray-400",children:["@",s.screen_id]})]})})]}),(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,r.jsxs)("span",{children:["レベル ",(0,r.jsx)("span",{className:"font-semibold",children:s.level})]}),(0,r.jsxs)("span",{children:["サポーター"," ",(0,r.jsx)("span",{className:"font-semibold",children:s.supporter_count?s.supporter_count.toLocaleString():""})]})]})]})},p=async e=>{let s=await fetch("".concat(e,"/recordings")),t=await s.json();return t.recordings},b=async(e,s)=>{let t=await fetch("".concat(e,"/recordings/").concat(s),{method:"POST"}),r=await t.json();return r},j=async(e,s)=>{let t=await fetch("".concat(e,"/recordings/").concat(s),{method:"DELETE"}),r=await t.json();return r},f=async e=>{let s=await fetch("".concat(e,"/users")),t=await s.json();return t.users},v=async(e,s)=>{let t=await fetch("".concat(e,"/subscriptions/").concat(s),{method:"POST"}),r=await t.json();return r},g=async(e,s)=>{let t=await fetch("".concat(e,"/subscriptions/").concat(s),{method:"DELETE"}),r=await t.json();return r};function N(){let[e,s]=(0,o.useState)([]),[t,n]=(0,o.useState)([]),[l,c]=(0,o.useState)(!1),[i,d]=(0,o.useState)("---"),[x,N]=(0,o.useState)("http://localhost:3880"),y=(0,o.useRef)(null),w=(0,o.useRef)(null),_=(0,o.useRef)(null),[k,E]=(0,o.useState)(30);return(0,o.useEffect)(()=>{""===x&&N("http://".concat(window.location.hostname,":").concat(window.location.port)),d("----/--/-- --:--:--"),p(x).then(e=>{s(e),d(a()().format("YYYY/MM/DD HH:mm:ss"))}),f(x).then(e=>{n(e)});let e=setInterval(()=>{c(e=>!e)},1e3*k);return()=>clearInterval(e)},[l,x,k]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h(),{children:(0,r.jsx)("title",{children:"TARS-UI"})}),(0,r.jsxs)("main",{className:"mx-10 my-10 space-y-10",children:[(0,r.jsxs)("div",{className:"flex w-1/2 items-center space-x-5 border-2 px-5 py-2",children:[(0,r.jsx)("span",{children:"更新間隔 (秒)"}),(0,r.jsx)("input",{type:"text",ref:_,defaultValue:"30",className:"w-16 rounded-3xl border-2 border-indigo-200 bg-gray-100 px-5 py-0.5 outline-none focus:border-emerald-400"}),(0,r.jsx)("button",{className:"rounded-2xl border-2 border-violet-400 px-4 py-1.5",onClick:()=>{var e,s;let t=Number(null===(e=_.current)||void 0===e?void 0:e.value)?Number(null===(s=_.current)||void 0===s?void 0:s.value):30;E(t)},children:"設定"}),(0,r.jsxs)("span",{className:"font-medium",children:["最終更新: ",i]})]}),(0,r.jsxs)("div",{className:"flex space-x-4 py-5",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold",children:["・録画タスク (",null==e?void 0:e.length,")"]}),(0,r.jsxs)("div",{className:"space-x-5",children:[(0,r.jsx)("input",{type:"text",ref:y,className:"rounded-3xl border-2 border-indigo-200 bg-gray-100 px-5 py-0.5 outline-none focus:border-emerald-400"}),(0,r.jsx)("button",{className:"rounded-2xl border-2 border-blue-400 px-4 py-1.5",onClick:()=>{var e;b(x,null===(e=y.current)||void 0===e?void 0:e.value),c(e=>!e)},children:"開始"}),(0,r.jsx)("button",{className:"rounded-2xl border-2 border-red-400 px-4 py-1.5",onClick:()=>{var e;j(x,null===(e=y.current)||void 0===e?void 0:e.value),c(e=>!e)},children:"終了"}),(0,r.jsx)("button",{className:"rounded-2xl border-2 border-violet-400 px-4 py-1.5",onClick:()=>c(e=>!e),children:"更新"})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2 md:grid-cols-6 md:gap-10",children:e&&e.map(e=>(0,r.jsx)(u,{recording:e},e.live_id))})}),(0,r.jsxs)("div",{className:"flex space-x-4 py-5",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold",children:["・自動録画対象 (",null==t?void 0:t.length,")"]}),(0,r.jsxs)("div",{className:"space-x-5",children:[(0,r.jsx)("input",{type:"text",ref:w,className:"rounded-3xl border-2 border-indigo-200 bg-gray-100 px-5 py-0.5 outline-none focus:border-emerald-400"}),(0,r.jsx)("button",{className:"rounded-2xl border-2 border-blue-400 px-4 py-1.5",onClick:()=>{var e;v(x,null===(e=w.current)||void 0===e?void 0:e.value),c(e=>!e)},children:"追加"}),(0,r.jsx)("button",{className:"rounded-2xl border-2 border-red-400 px-4 py-1.5",onClick:()=>{var e;g(x,null===(e=w.current)||void 0===e?void 0:e.value),c(e=>!e)},children:"削除"})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"grid grid-cols-5 gap-4 lg:gap-10",children:t&&t.map(e=>(0,r.jsx)(m,{user:e},e.user_id))})})]})]})}}},function(e){e.O(0,[459,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);